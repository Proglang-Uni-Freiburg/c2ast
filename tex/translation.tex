\section{Translating equi-recursion to iso-recursion}

The set of syntactically valid expressions in the equi-recursive system is a
subset of the syntactically valid expressions in the iso-recursive system. A
simple one-to-one mapping, however, does not preserve well-typedness because
the target type system is more strict.

\input{fig-translation}

Instead, the translation judgment $\translation e {e'} T$ in
Figure~\ref{fig:translation} describes the translation of equi-recursively
typed expression $e$ to an equivalent expression $e'$ in the iso-recursive
system. The interesting part of the translation process is where the
equi-recursive system makes use of type conversions. Here, an appriopriate
conversion function is inserted on the iso-recursive side.

The translation preserves well-typedness and the original and the
resulting process are \highlight{``wire-compatible''}. \js{what is the correct
word?} \pt{I've used that word, but the actual technical content is more tricky
than I imagined.}

% \begin{align*}
%   \dtransDef[\TUnit] \EUnit &= \EUnit &
%   \dtransDef x &= x \\
%   \dtransDef {\ELam x e} &= \ELam x \dtrans e &
%   \dtransDef {\ERec x e} &= \ERec x \dtrans e \\
%   \dtransDef {e_1 \; e_2} &= \dtrans{e_1} \; \dtrans{e_2} &
%   \dtransDef {\ELetU {e_1} {e_2}} &= \ELetU {\dtrans{e_1}} {\dtrans{e_2}} \\
%   \dtransDef {(e_1,e_2)} &= (\dtrans{e_1},\dtrans{e_2}) &
%   \dtransDef {\ELetP xy {e_1} {e_2}} &= \ELetP xy {\dtrans{e_1}} \dtrans{e_2} \\
% \end{align*}
% 
% \declrel{Typing derivation translation}
% \begin{mathpar}
%   \derivTransRule{ }{\typing \EUnit \TUnit}{\EUnit} \and
%   \derivTransRule{ }{\typing x T}{x} \and
%   
%   \derivTransRule{\DT e}{
%     \typing{\ELam x e}{U}
%   }{
%     \ELam x \derivTrans e
%   }
% 
%   \derivTransRule{\DT e}{
%     \typing{\ERec x e}{U}
%   }{
%     \ERec x \derivTrans e
%   }
% 
%   \derivTransRule{\DT {e_1} \\ \DT {e_2}}{
%     \typing[\CSplit]{e_1 e_2}{T_2}
%   }{
%     \derivTrans{e_1} \derivTrans{e_2}
%   }
% 
%   \derivTransRule{\DT {e_1} \\ \DT {e_2}}{
%     \typing{ \ELetU{e_1}{e_2} }{ T_2 }
%   }{
%     \ELetU {\derivTrans {e_1}} {\derivTrans {e_2}}
%   }
% 
%   \derivTransRule{\DT e \\ f : T \eqt U : f'}{
%     \typing e U
%   }{
%     f \; \derivTrans e
%   }
% \end{mathpar}

%%% Local Variables:
%%% mode: latex
%%% TeX-master: "main"
%%% End:
